<?php
////$sD = "MIIDLwYJKoZIhvcNAQcCoIIDIDCCAxwCAQExDjAMBgoqhiQCAQEBAQIBMBsGCSqGSIb3DQEHAaAOBAw0ADUANgA0ADUANgAxggLoMIIC5AIBATCB3DCBwzEWMBQGA1UECgwN0JDQoiAi0IbQhtCiIjEgMB4GA1UECwwX0KLQtdGB0YLQvtCy0LjQuSDQptCh0JoxLjAsBgNVBAMMJdCi0LXRgdGC0L7QstC40Lkg0KbQodCaINCQ0KIgItCG0IbQoiIxFDASBgNVBAUMC1VBLTIyNzIzNDcyMQswCQYDVQQGEwJVQTEVMBMGA1UEBwwM0KXQsNGA0LrRltCyMR0wGwYDVQQIDBTQpdCw0YDQutGW0LLRgdGM0LrQsAIUW2PYg3XZIBgEAAAA3AAAAGUBAAAwDAYKKoYkAgEBAQECAaCCAZ8wggEyBgsqhkiG9w0BCRACLzGCASEwggEdMIIBGTCCARUwDAYKKoYkAgEBAQECAQQgnxEUYCARBnUWIH+auqBuyCBxck33Aota5xSI44a8M+kwgeIwgcmkgcYwgcMxFjAUBgNVBAoMDdCQ0KIgItCG0IbQoiIxIDAeBgNVBAsMF9Ci0LXRgdGC0L7QstC40Lkg0KbQodCaMS4wLAYDVQQDDCXQotC10YHRgtC+0LLQuNC5INCm0KHQmiDQkNCiICLQhtCG0KIiMRQwEgYDVQQFDAtVQS0yMjcyMzQ3MjELMAkGA1UEBhMCVUExFTATBgNVBAcMDNCl0LDRgNC60ZbQsjEdMBsGA1UECAwU0KXQsNGA0LrRltCy0YHRjNC60LACFFtj2IN12SAYBAAAANwAAABlAQAAMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwLwYJKoZIhvcNAQkEMSIEIGFDzqUxCG3SeIF5QsA6Kp05Gh+w6S2HqknGweAPxeaIMBwGCSqGSIb3DQEJBTEPFw0xNDA3MTcyMDA1MjdaMA0GCyqGJAIBAQEBAwEBBECAXOedl+zwGuryYABSdONG4d8+xvCScO/SnlTBvs8UEyoBDQ1LaqX1YhQAo3Ah0LdL9EH+ujsDOyUtak7lL+Ze";

// Dir, internal sign + cert
//$sD = "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";
// Dir, internal sign + cert + TSP
//$sD = "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";

//Dir Молодший + internal sign
//$sD = "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";
$sD = "MIIDHwYJKoZIhvcNAQcCoIIDEDCCAwwCAQExDjAMBgoqhiQCAQEBAQIBMAsGCSqGSIb3DQEHATGCAugwggLkAgEBMIHcMIHDMRYwFAYDVQQKDA3QkNCiICLQhtCG0KIiMSAwHgYDVQQLDBfQotC10YHRgtC+0LLQuNC5INCm0KHQmjEuMCwGA1UEAwwl0KLQtdGB0YLQvtCy0LjQuSDQptCh0Jog0JDQoiAi0IbQhtCiIjEUMBIGA1UEBQwLVUEtMjI3MjM0NzIxCzAJBgNVBAYTAlVBMRUwEwYDVQQHDAzQpdCw0YDQutGW0LIxHTAbBgNVBAgMFNCl0LDRgNC60ZbQstGB0YzQutCwAhRbY9iDddkgGAQAAADrBAAAYwoAADAMBgoqhiQCAQEBAQIBoIIBnzCCATIGCyqGSIb3DQEJEAIvMYIBITCCAR0wggEZMIIBFTAMBgoqhiQCAQEBAQIBBCDwZa1lQ9zfEsOlTfR39J5hZ/2AWSa++kYNZmkM2FqFpDCB4jCByaSBxjCBwzEWMBQGA1UECgwN0JDQoiAi0IbQhtCiIjEgMB4GA1UECwwX0KLQtdGB0YLQvtCy0LjQuSDQptCh0JoxLjAsBgNVBAMMJdCi0LXRgdGC0L7QstC40Lkg0KbQodCaINCQ0KIgItCG0IbQoiIxFDASBgNVBAUMC1VBLTIyNzIzNDcyMQswCQYDVQQGEwJVQTEVMBMGA1UEBwwM0KXQsNGA0LrRltCyMR0wGwYDVQQIDBTQpdCw0YDQutGW0LLRgdGM0LrQsAIUW2PYg3XZIBgEAAAA6wQAAGMKAAAwGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAvBgkqhkiG9w0BCQQxIgQg0IscD5cVLIL9VYwLuuqM8UiEHvG8nY371v+7gMtDmoMwHAYJKoZIhvcNAQkFMQ8XDTE0MDkxNTE5NTEwN1owDQYLKoYkAgEBAQEDAQEEQB9d9L8ObYin+EgAcXVsgFkKudcGvykVuOY4lnvWDVoUYUMhyv9xNt7wdRt5hTahm1NmC9f+AQJmNhCybxT693I=";
echo getenv("LD_LIBRARY_PATH")."<br>";
//$signed64 = file_get_contents("signed.txt");
$signed64 = $sD;

$i1 = 0;
euspe_init($i1);

$s1 = "";
euspe_geterrdescr($i1, $s1);
echo $s1;

$sData="";	// Входящий. Данные для подписи
$sSignTime="";	// Вихідний. Час підпису в форматі 
		// MM.DD.YYYY HH:ii:ss. Передається за 
		// посиланням
$bUseTSP="";	// Вихідний. Чи використовувався TSP.
		// Передається за посиланням
$sIssuer="";	//* Вихідний. Видавник сертифікату.
		// Передається за посиланням
$sIssuerCN="";	//* Вихідний. Загальне ім’я видавника.
		// Передається за посиланням
$sSerial="";	//* Вихідний. Серійний номер сертифікату.
		// Передається за посиланням
$sSubject="";	//* Вихідний. Власник сертифікату.
		// Передається за посиланням
$sSubjCN="";	// Вихідний. Загальне ім’я власника.
		// Передається за посиланням
$sSubjOrg="";	//* Вихідний. Організація.
		// Передається за посиланням
$sSubjOrgUnit="";	//* Вихідний. Підрозділ.
			// Передається за посиланням
$sSubjTitle="";	//* Вихідний. Посада.
		// Передається за посиланням
$sSubjState="";	//* Вихідний. Область.
		// Передається за посиланням
$sSubjLocality="";	//* Вихідний. Місто.
			// Передається за посиланням
$sSubjFullName="";	//* Вихідний. Повне ім’я.
			// Передається за посиланням
$sSubjAddress="";	//* Вихідний. Адреса.
			// Передається за посиланням
$sSubjPhone="";	//* Вихідний. Телефон.
		// Передається за посиланням
$sSubjEMail="";	//* Вихідний. E-mail.
		// Передається за посиланням
$sSubjDNS="";	//* Вихідний. DNS.
		// Передається за посиланням
$sSubjEDRPOUCode="";	//* Вихідний. ЄДРПОУ код.
			// Передається за посиланням
$sSubjDRFOCode="";	//* Вихідний. ДРФО код.
			// Передається за посиланням
$sResultData="";	//* Вихідний. Перевірені дані.
			// Передається за посиланням
$iErrorCode="";		// Вихідний. Код помилки. Передається за 
			// посиланням
// shortest form
//$i = euspe_signverify($sData, $sSignTime, $bUseTSP, $sSubjCN, $iErrorCode);

// longest form
//$i = euspe_signverify($sData, $sSignTime, $bUseTSP, $sIssuer, $sIssuerCN, $sSerial, $sSubject, $sSubjCN, $sSubjOrg, $sSubjOrgUnit, $sSubjTitle, $sSubjState, $sSubjLocality, $sSubjFullName, $sSubjAddress, $sSubjPhone, $sSubjEmail, $sSubjDNS, $sSubjEDRPOUCode, $sSubjDRFOCode, $sResultData, $iErrorCode);

//$sData = $signed64;
$signed = base64_decode($sD);
//$sData = $signed;
//$sData = "1";
$sData = file_get_contents("s1.txt");
//$signed = file_get_contents("s1.txt.p7s");
$i1 = euspe_signverifyext($sData, $signed, $sSignTime, $bUseTSP, $sIssuer, $sIssuerCN, $sSerial, $sSubject, $sSubjCN, $sSubjOrg, $sSubjOrgUnit, $sSubjTitle, $sSubjState, $sSubjLocality, $sSubjFullName, $sSubjAddress, $sSubjPhone, $sSubjEmail, $sSubjDNS, $sSubjEDRPOUCode, $sSubjDRFOCode, $iErrorCode);
echo $iErrorCode."<br>";
$s1="";
euspe_geterrdescr($iErrorCode, $s1);
echo "Error: ".$iErrorCode."; ".$s1."<br>";
//echo "sData: ".$sData."<br>";
echo "sSignTime; ".$sSignTime."<br>";
echo "bUseTSP: ".$bUseTSP."<br>";
echo "sResultData: ".$sResultData."<br>";
echo "sIssuer: ".$sIssuer."<br>";
echo "sSerial: ".$sSerial."<br>";
echo "sSubjDRFOCode: ".$sSubjDRFOCode."<br>";
echo "sSubjEDRPOUCode: ".$sSubjEDRPOUCode."<br>";

?>
